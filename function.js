`;function Gk({item:e,runes:t,coefficient:n,setCoefficient:r,itemPrice:o,setItemPrice:i,servers:s,selectedServer:a,handleServerChange:l,setRunes:u,refreshSelectedItem:c}){const[f,d]=b.useState(!1),[v,y]=b.useState([]),[x,w]=b.useState(n),[g,p]=b.useState(null),[m,S]=b.useState(o),[P,C]=b.useState(null),[E,I]=b.useState({}),[z,B]=b.useState(!0),{i18n:K,t:q}=Gt();Ag(),b.useEffect(()=>{if(e&&a){const O=e.coefficients.find(G=>G.serverName===a.name);O&&(w(O.coefficient),p(new Date(O.lastUpdate)));const F=e.prices.find(G=>G.serverName===a.name);F&&(S(F.price),C(new Date(F.lastUpdate)))}},[e,a]),b.useEffect(()=>{if(!e||!a)return;const O={};e.characteristics.forEach(F=>{F.to<F.from&&F.from>0||F.to>F.from&&F.from<0?(F.to=F.from,O[F.id]=F.from):O[F.id]=Math.round((F.from+F.to)/2)}),I(O)},[e.id,a,e.characteristics]),b.useEffect(()=>{if(f){const F=JSON.parse(localStorage.getItem("localRunePrices")||"{}")[a.name]||{},G=t.map(X=>{const M=F[X.id];return{...X,latestPrices:X.latestPrices.map(H=>H.serverName===a.name?{...H,price:M!==void 0?M:1}:H)}});y(G)}else y(t)},[t,f,a]);const _e=(O,F,G,X)=>O<0?3*O/(200*X)+1:3*O*F*G/(200*X)+1,N=(O,F)=>O.reduce((G,X)=>{if(X.name[K.language]==="Unknown characteristic")return G;const M=_(X.id);if(!M)return 0;const H=M?M.weight:1,ee=M?M.value:1,xe=E[X.id]!==void 0?E[X.id]:0,ft=_e(xe,H,e.level,ee);return X.id===F?G+ft:G+.5*ft},0),_=O=>v.find(F=>F.characteristicId===O),T=O=>{const F=O.latestPrices.find(G=>G.serverName===a.name);return F?F.price:0},$=(O,F)=>{y(G=>G.map(X=>X.id===O?{...X,latestPrices:X.latestPrices.map(M=>M.serverName===a.name?{...M,price:F===""?"":Number(F)}:M)}:X))},k=async(O,F)=>{if(F!=="")if(f)try{const G=Number(F),X=JSON.parse(localStorage.getItem("localRunePrices")||"{}");X[a.name]||(X[a.name]={}),X[a.name][O]=G,localStorage.setItem("localRunePrices",JSON.stringify(X))}catch(G){console.error("Error saving local rune price:",G)}else try{await ie.put(`${qa}/runes/${O}/prices`,{serverName:a.name,price:Number(F)}),y(G=>G.map(X=>X.id===O?{...X,latestPrices:X.latestPrices.map(M=>M.serverName===a.name?{...M,price:Number(F)}:M)}:X)),u&&u(G=>G.map(X=>X.id===O?{...X,latestPrices:X.latestPrices.map(M=>M.serverName===a.name?{...M,price:Number(F)}:M)}:X))}catch(G){console.error("Error updating rune price:",G)}},j=O=>{w(O)},D=async O=>{if(O!=="")try{const F=await ie.put(`${qa}/items/${e.id}/coefficients`,{serverName:a.name,coefficient:Number(O)});r(Number(O)),F.data.coefficient&&F.data.coefficient.dateUpdated&&p(new Date(F.data.coefficient.dateUpdated)),c()}catch(F){console.error("Error updating coefficient:",F)}},V=O=>{const F=Number(O.replace(/\s/g,""));!isNaN(F)&&F<=1e9&&S(F)},W=async O=>{const F=Number(O.replace(/\s/g,""));if(!(isNaN(F)||O===""||F>1e9||F<=0))try{const G=await ie.put(`${qa}/items/${e.id}/prices`,{serverName:a.name,price:Number(O)});i(Number(O)),G.data.price&&G.data.price.dateUpdated&&C(new Date(G.data.price.dateUpdated)),c()}catch(G){console.error("Error updating item price:",G)}},re=(O,F)=>{I(G=>({...G,[O]:F===""?"":Number(F)}))},te=O=>{I(F=>{const G=Number(F[O])||0;return{...F,[O]:G-1}})},Me=O=>{I(F=>{const G=Number(F[O])||0;return{...F,[O]:G+1}})},se=b.useMemo(()=>e.characteristics.filter(O=>O.name[K.language]!=="Unknown characteristic").map(O=>{var Lc;let F=O.from,G=O.to;const X=O.id===696969,M=F<0,H=_(O.id),ee=H?T(H):0,xe=E[O.id]!==void 0&&E[O.id]!==""?Number(E[O.id]):Math.round((F+G)/2),ft=xe<0,Jt=H?H.weight:1,Yt=H?H.value:1,bn=H&&!M?(_e(xe,Jt,e.level,Yt)*x/100/Jt).toFixed(2):null,$c=H&&!M?(bn*ee).toFixed(0):null;let sa=null,aa=null;if(!M&&!X&&H){const Nc=(N(e.characteristics,O.id)*x/100/H.weight).toFixed(2);sa=parseFloat(Nc),aa=parseFloat((Nc*ee).toFixed(0))}return{...O,jet:xe,jetIsNegative:ft,isChasse:X,name:O.name[K.language]||O.name.fr,runeName:H?(Lc=H.name[K.language])==null?void 0:Lc.replace("Rune ",""):null,runePrice:ee,runeImageUrl:H?H.imageUrl:null,runesObtained:sa?parseFloat(sa):null,kamasObtained:aa?parseFloat(aa):null,runesWithoutFocus:bn?parseFloat(bn):null,kamasWithoutFocus:$c?parseFloat($c):null,runeId:H?H.id:null,isNegative:M}}),[e,v,E,x,a,K.language]),le=se.reduce((O,F)=>O+(F.kamasWithoutFocus||0),0),qe=()=>B(O=>!O),Qe=[{id:"totalKamasWithoutFocus",value:le},...se.map(O=>({id:O.id,value:O.kamasObtained||0}))].sort((O,F)=>F.value-O.value),nt=z?Qe.slice(0,1):Qe.slice(0,3),Be={};nt.forEach((O,F)=>{Be[O.id]=F+1});const Jn=b.useMemo(()=>{var F;return(((F=Qe[0])==null?void 0:F.value)||0)-m},[Qe,m]);return h.jsxs(h.Fragment,{children:[h.jsxs(yc,{children:[h.jsx("html",{lang:K.language}),h.jsxs("title",{children:["DoFocus - ",e==null?void 0:e.name[K.language]]}),h.jsx("meta",{name:"description",content:`${q("seo.description")} ${e==null?void 0:e.name[K.language]}`}),h.jsx("meta",{property:"og:title",content:`DoFocus - ${e==null?void 0:e.name[K.language]}`}),h.jsx("meta",{property:"og:description",content:`${q("seo.description")} ${e==null?void 0:e.name[K.language]}`}),h.jsx("meta",{property:"og:image",content:e==null?void 0:e.imageUrl}),h.jsx("meta",{property:"og:url",content:`https://dofocus.fr${location.pathname}`}),h.jsx("meta",{property:"og:type",content:"product"}),h.jsx("meta",{property:"og:site_name",content:"DoFocus"}),h.jsx("meta",{name:"keywords",content:`${e==null?void 0:e.name[K.language]}, ${q("seo.main_keywords")}`}),h.jsx("meta",{name:"robots",content:"index,follow"}),h.jsx("meta",{name:"language",content:K.language})]}),h.jsxs(jk,{children:[h.jsxs($k,{children:[h.jsx(Lk,{src:e.imageUrl,alt:e.name[K.language]}),h.jsxs(Nk,{children:[e.name[K.language]," ",h.jsx("br",{})," ",h.jsxs("em",{style:{fontSize:"1.2rem",fontStyle:"italic"},children:[q("level")," ",e.level]})]}),h.jsxs(Dk,{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[h.jsx(zd,{children:q("coefficient")}),h.jsx(Fk,{type:"number",value:x,onChange:O=>j(O.target.value),onBlur:O=>D(O.target.value),min:"0",step:"1"}),h.jsx(zd,{children:" %"})]}),g&&h.jsxs(zk,{children:[g.toLocaleDateString("fr-FR")," à"," ",g.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"-40px"},children:[h.jsx(Ak,{profit:Jn,children:h.jsxs("span",{children:[q("estimation")," :"," ",h.jsxs("span",{className:"profit-value",children:[Jn>0?`+${Jn.toLocaleString("fr-FR")}`:Jn.toLocaleString("fr-FR")," k"]})]})}),h.jsx("div",{style:{alignSelf:"flex-end",marginTop:"-20px"},children:h.jsx(Wd,{style:{marginBottom:"10px",marginRight:"20px"},children:h.jsxs(qd,{children:[h.jsx("span",{children:"Top 1"}),h.jsxs(Kd,{children:[h.jsx("input",{type:"checkbox",checked:!z,onChange:qe}),h.jsx("span",{})]}),h.jsx("span",{children:"Top 3"})]})})})]}),h.jsxs(Wk,{children:[h.jsxs("thead",{children:[h.jsxs("tr",{style:{position:"relative"},children:[h.jsx("th",{colSpan:"2",style:{background:"none"},children:h.jsxs(Mk,{children:[h.jsxs(Uk,{children:[h.jsx(Bk,{children:q("item_price")}),h.jsx(Vk,{type:"text",value:m.toLocaleString("fr-FR"),onChange:O=>V(O.target.value.replace(/\s/g,"")),onBlur:O=>W(O.target.value.replace(/\s/g,""))}),h.jsx("img",{src:Ok,alt:"Kama",style:{width:"20px",marginLeft:"6px"}})]}),P&&h.jsxs(Hk,{children:[P.toLocaleDateString("fr-FR")," à"," ",P.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]})}),h.jsx("th",{colSpan:"2",style:{background:"none"}}),h.jsx("th",{colSpan:"2",style:{textAlign:"center",backgroundColor:"#2b2b2b",paddingTop:"15px",paddingBottom:"15px",fontWeight:"bold",borderTopLeftRadius:"45px",borderTopRightRadius:"45px"},children:q("without_focus")}),h.jsx("th",{colSpan:"2",style:{textAlign:"center",backgroundColor:"#2b2b2b",paddingTop:"15px",paddingBottom:"15px",fontWeight:"bold",borderTopLeftRadius:"45px",borderTopRightRadius:"45px"},children:q("with_focus")})]}),h.jsxs("tr",{children:[h.jsx(en,{style:{borderTopLeftRadius:"8px"},children:q("characteristic")}),h.jsx(en,{children:q("jet")}),h.jsx(en,{children:q("rune")}),h.jsxs(en,{children:[q("price"),h.jsx(Wd,{style:{marginTop:"10px",marginBottom:"-10px",marginLeft:"-20px"},children:h.jsxs(qd,{children:[q("online"),h.jsxs(Kd,{children:[h.jsx("input",{type:"checkbox",checked:f,onChange:O=>d(O.target.checked)}),h.jsx("span",{})]}),q("local")]})})]}),h.jsx(en,{children:q("runes")}),h.jsx(en,{children:q("kamas")}),h.jsx(en,{children:q("runes")}),h.jsx(en,{children:q("kamas")})]})]}),h.jsxs("tbody",{children:[se.map(O=>h.jsxs(Md,{children:[h.jsx(Ga,{style:{color:O.isNegative?jc:"inherit"},children:O.name}),h.jsx(Bd,{children:h.jsxs(qk,{children:[h.jsx(Hd,{isNegative:O.jetIsNegative,children:O.from}),h.jsx(Vd,{onClick:()=>te(O.id),children:"-"}),h.jsx(Qk,{type:"number",value:E[O.id]||"",onChange:F=>re(O.id,F.target.value),min:O.from,max:O.to,isNegative:O.jetIsNegative}),h.jsx(Vd,{onClick:()=>Me(O.id),children:"+"}),h.jsx(Hd,{isNegative:O.jetIsNegative,children:O.to})]})}),h.jsxs(Ga,{children:[h.jsx(Ik,{src:O.runeImageUrl,alt:O.runeName}),O.runeName]}),h.jsx(Bd,{children:O.isNegative?"":O.runeId&&h.jsx(Kk,{isLocal:f,type:"number",value:O.runePrice!==""?O.runePrice:"",onChange:F=>$(O.runeId,F.target.value),onBlur:F=>k(O.runeId,F.target.value),min:"0"})}),h.jsx(Ud,{children:O.isNegative||O.runesWithoutFocus===null?"":O.runesWithoutFocus.toLocaleString("fr-FR")}),h.jsx(Qa,{style:{borderRight:"1px double #555",opacity:O.isNegative||O.kamasWithoutFocus===null?.5:1},children:O.isNegative||O.kamasWithoutFocus===null?"":`${O.kamasWithoutFocus.toLocaleString("fr-FR")} k`}),h.jsx(Ud,{children:O.isNegative||O.isChasse||O.runesObtained===null?"":O.runesObtained.toLocaleString("fr-FR")}),h.jsx(Qa,{rank:Be[O.id],style:O.isNegative||O.isChasse||O.kamasObtained===null?{opacity:.5}:{},children:O.isNegative||O.isChasse||O.kamasObtained===null?"":`${O.kamasObtained.toLocaleString("fr-FR")} k`})]},O.id)),h.jsxs(Md,{children:[h.jsxs(Ga,{colSpan:"6",style:{textAlign:"right",fontWeight:"bold"},children:[q("total_kamas_without_focus")," :"]}),h.jsxs(Qa,{colSpan:"2",rank:Be.totalKamasWithoutFocus,style:{fontWeight:"bold",textAlign:"center"},children:[le.toLocaleString("fr-FR")," k"]})]})]})]})]})]})}const Jk=L.div`
